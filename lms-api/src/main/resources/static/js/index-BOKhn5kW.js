var R=Object.defineProperty;var x=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var P=(s,e,o)=>e in s?R(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,E=(s,e)=>{for(var o in e||(e={}))T.call(e,o)&&P(s,o,e[o]);if(x)for(var o of x(e))j.call(e,o)&&P(s,o,e[o]);return s};import{r as y,f as C,v as F,b as G,o as H,q as O,H as r,R as p,az as g,D as _,p as W,j as n,G as f,aA as J,S as b,P as S,aB as K}from"./index-B4LUeTLg.js";import"./index-BnRV7d3v.js";import{P as Q}from"./index-c2-hsIFG.js";import{t as z,a as B}from"./common-CBPeEccM.js";import{q as X,f as Y,c as Z}from"./book-D9SslOf9.js";function ee(){const s=y([]),e=y(!0),o=[{label:"书号",prop:"isbn",width:160},{label:"书籍位置",prop:"position",slot:"positionSlot",width:120},{label:"书名",prop:"name",width:200},{label:"作者",prop:"author"},{label:"译者",prop:"translator"},{label:"出版单位",prop:"publisher",width:120},{label:"出版版次",prop:"edition",width:120},{label:"书名检索词",prop:"nameIndex",width:120},{label:"作者检索词",prop:"authorIndex",width:120},{label:"主题检索词",prop:"topicIndex",width:120},{label:"分类号",prop:"classify"},{label:"CIP核字",prop:"cipNum",width:120},{label:"数量",prop:"counts"},{label:"在馆数量",prop:"libCounts",width:100},{label:"状态",prop:"status",width:80,slot:"statusSlot"},{label:"操作",width:"120",fixed:"right",slot:"operation"}],k=C({pageSize:10,currentPage:1,pageSizes:[10,20,50],total:0,align:"right",background:!0,size:"default"}),m=C({text:"正在加载第一页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `});return{loading:e,columns:o,dataList:s,pagination:k,loadingConfig:m}}const te=f("h5",null,"数据筛选",-1),oe={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ae=f("h5",null,"数据列表",-1),re=F({name:"BookManagement",__name:"index",setup(s){let e=C({bookPositionEnums:[],bookStatusEnums:[]});const o=G();function k(){X().then(t=>{if(t.code===200){let a=t.data,i=z(a.bookPositionEnums);e.bookPositionEnums.push(...i);let u=z(a.bookStatusEnums);e.bookStatusEnums.push(...u)}else g(t.message,{type:"error"})}).catch(()=>{})}const m=y({}),N=[{label:"书籍名称",prop:"name"},{label:"书籍位置",prop:"position",valueType:"select",options:e.bookPositionEnums},{label:"书号",prop:"isbn"},{label:"作者",prop:"author"},{label:"状态",prop:"status",valueType:"select",options:e.bookStatusEnums}],I=t=>{d()},q=()=>{d()},{loading:h,columns:L,dataList:v,pagination:c,loadingConfig:w}=ee();function U(t){c.pageSize=t,d()}function V(t){c.currentPage=t,d(),w.text=`正在加载第${t}页...`}function d(){let t=m.value,a=E({pageNo:c.currentPage,pageSize:c.pageSize},t);Y(a).then(i=>{var u;i.code===200?(v.value=((u=i.data)==null?void 0:u.rows)||[],c.total=i.data.total,h.value=!1):(h.value=!1,g(i.message,{type:"error"}))}).catch(()=>{h.value=!1})}function $(t){o.push({path:`/book/edit/${t.bookUniqueId}`})}function M(t){K.confirm(`确定${t.status==="N"?"下架":"上架"}本条记录`,"信息",{type:"warning"}).then(()=>{Z({bookUniqueId:t.bookUniqueId,status:t.status==="N"?"S":"N"}).then(a=>{a.code===200?(g("操作成功",{type:"success"}),d()):(h.value=!1,g(a.message,{type:"error"}))})}).catch(()=>{})}return H(()=>{k(),d()}),(t,a)=>{const i=_("el-card"),u=_("el-button"),A=_("pure-table");return W(),O("div",null,[r(i,null,{header:p(()=>[te]),default:p(()=>[r(n(Q),{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=l=>m.value=l),columns:N,"label-width":"90","label-position":"right",hasUnfold:!1,onSearch:I,onReset:q},null,8,["modelValue"])]),_:1}),r(i,{style:{"margin-top":"16px"}},{default:p(()=>[f("div",oe,[ae,r(u,{type:"primary",icon:n(J),onClick:a[1]||(a[1]=l=>n(o).push("/book/add"))},{default:p(()=>[b("新增书籍")]),_:1},8,["icon"])]),f("div",null,[r(A,{style:{"margin-top":"16px"},border:"",stripe:"","row-key":"bookUniqueId",alignWhole:"left",showOverflowTooltip:"",loading:n(h),"loading-config":n(w),data:n(v),columns:n(L),pagination:n(c),onPageSizeChange:U,onPageCurrentChange:V},{positionSlot:p(({row:l})=>[b(S(n(B)(l.position,n(e).bookPositionEnums)),1)]),statusSlot:p(({row:l})=>[b(S(n(B)(l.status,n(e).bookStatusEnums)),1)]),operation:p(({row:l})=>[r(u,{link:"",type:"primary",onClick:D=>$(l)},{default:p(()=>[b(" 编辑 ")]),_:2},1032,["onClick"]),r(u,{link:"",type:"primary",onClick:D=>M(l)},{default:p(()=>[b(S(l.status==="N"?"下架":"上架"),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","loading-config","data","columns","pagination"])])]),_:1})])}}});export{re as default};
