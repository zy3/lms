var B=Object.defineProperty;var v=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var w=(t,o,e)=>o in t?B(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,P=(t,o)=>{for(var e in o||(o={}))N.call(o,e)&&w(t,e,o[e]);if(v)for(var e of v(o))q.call(o,e)&&w(t,e,o[e]);return t};import"./index-BnRV7d3v.js";import{P as D}from"./index-c2-hsIFG.js";import{r as b,f,v as A,o as M,q as R,H as d,R as m,az as k,D as x,p as T,j as l,G as _,S as U,P as I}from"./index-B4LUeTLg.js";import{t as j,a as F}from"./common-CBPeEccM.js";import{q as G,n as H}from"./book-D9SslOf9.js";function O(){const t=b([]),o=b(!0),e=[{label:"书号",prop:"isbn",width:160},{label:"书籍位置",prop:"position",slot:"positionSlot",width:120},{label:"书籍名称",prop:"name",width:200},{label:"作者",prop:"author"},{label:"译者",prop:"translator"},{label:"出版单位",prop:"publisher",width:120},{label:"出版版次",prop:"edition",width:120},{label:"分类号",prop:"classify"},{label:"CIP核字",prop:"cipNum",width:120},{label:"数量",prop:"counts"},{label:"在馆数量",prop:"libCounts",width:100}],r=f({pageSize:10,currentPage:1,pageSizes:[10,20],total:0,align:"right",background:!0,size:"default"}),h=f({text:"正在加载第一页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `});return{loading:o,columns:e,dataList:t,pagination:r,loadingConfig:h}}const W=_("h5",null,"数据筛选",-1),$=_("h5",null,"图书检索",-1),J={style:{"margin-top":"16px"}},eo=A({name:"Search",__name:"index",setup(t){let o=f({bookPositionEnums:[]});function e(){G().then(a=>{if(a.code===200){const i=a.data,n=j(i.bookPositionEnums);o.bookPositionEnums.push(...n)}else k(a.message,{type:"error"})}).catch(()=>{})}const r=b({}),h=[{label:"书籍名称",prop:"name"},{label:"书籍位置",prop:"position",valueType:"select",options:o.bookPositionEnums},{label:"书号",prop:"isbn"},{label:"作者",prop:"author"}],y=()=>{u()},z=()=>{u()},{loading:p,columns:E,dataList:C,pagination:s,loadingConfig:S}=O();function L(a){s.pageSize=a,u()}function V(a){s.currentPage=a,u(),S.text=`正在加载第${a}页...`}function u(){p.value=!0;let a=r.value,i=P({pageNo:s.currentPage,pageSize:s.pageSize},a);H(i).then(n=>{var c;n.code===200?(C.value=((c=n.data)==null?void 0:c.rows)||[],s.total=n.data.total,p.value=!1):(p.value=!1,k(n.message,{type:"error"}))}).catch(()=>{p.value=!1})}return M(()=>{e(),u()}),(a,i)=>{const n=x("el-card"),c=x("pure-table");return T(),R("div",null,[d(n,null,{header:m(()=>[W]),default:m(()=>[d(l(D),{modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=g=>r.value=g),columns:h,"label-width":"90","label-position":"right",hasUnfold:!1,onSearch:y,onReset:z},null,8,["modelValue"])]),_:1}),d(n,{style:{"margin-top":"16px"}},{default:m(()=>[$,_("div",J,[d(c,{border:"",stripe:"","row-key":"bookUniqueId",alignWhole:"left",showOverflowTooltip:"",loading:l(p),"loading-config":l(S),data:l(C),columns:l(E),pagination:l(s),onPageSizeChange:L,onPageCurrentChange:V},{positionSlot:m(({row:g})=>[U(I(l(F)(g.position,l(o).bookPositionEnums)),1)]),_:1},8,["loading","loading-config","data","columns","pagination"])])]),_:1})])}}});export{eo as default};
