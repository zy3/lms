import{u as C,b as x,aC as E,aD as P,l as y,v as S,r as g,f as D,o as U,U as V,R as r,az as m,D as _,p as N,G as i,P as w,H as f,j as k,S as h,a8 as A}from"./index-B4LUeTLg.js";import{t as F}from"./common-CBPeEccM.js";import{P as M}from"./index-BnRV7d3v.js";import{q as R,d as j,e as L}from"./book-D9SslOf9.js";function W(){const s=C(),t=x(),n=E(s.params)?s.query:s.params;function p(e,u){Object.keys(e).forEach(l=>{P(e[l])||(e[l]=e[l].toString())}),u==="add"?(y().handleTags("push",{path:"/book/bookAdd",name:"BookAdd",params:e,meta:{title:"新增书籍",dynamicLevel:1}}),t.push({name:"BookAdd"})):u==="params"&&(y().handleTags("push",{path:"/book/bookEdit/:id",name:"BookEdit",params:e,meta:{title:"编辑书籍",dynamicLevel:1}}),t.push({name:"BookEdit",params:e}))}return{toDetail:p,initToDetail:e=>{n&&p(n,e)},getParameter:n,router:t}}const z={style:{display:"flex","justify-content":"space-between"}},H=i("span",{style:{"font-size":"11px",color:"#999"}},[i("span",{style:{color:"#f00"}},"*"),h(" 为必填项")],-1),O={style:{margin:"40px auto 0"}},X=S({name:"BookForm",__name:"BookForm",props:{pageType:{type:String,default:"edit"},bookUniqueId:{type:String}},setup(s){const t=s,n=x();let p=g(!1),b=D({bookPositionEnums:[]}),e=g({author:"",authorIndex:"",cipNum:"",classify:"",counts:1,edition:"",isbn:"",name:"",nameIndex:"",position:"",publisher:"",topicIndex:"",translator:""});const u=()=>{m("取消提交",{type:"warning"}),n.push("/bookManagement")},l=o=>{L(o,t.pageType).then(a=>{a.code===200?(m("提交成功",{type:"success"}),n.push("/bookManagement")):m(a.message,{type:"error"})})};function T(){R().then(o=>{if(o.code===200){let a=o.data,d=F(a.bookPositionEnums);b.bookPositionEnums.push(...d)}}).catch(()=>{})}function q(){j({bookUniqueId:t.bookUniqueId}).then(o=>{o.code===200?e.value=o.data:m(o.message,{type:"error"})})}U(()=>{T(),t.pageType&&t.bookUniqueId&&q()});const v={isbn:[{required:!0,message:"请输入书号"}],counts:[{required:!0,message:"请输入数量"}],position:[{required:!0,message:"请选择书籍位置"}],name:[{required:!0,message:"请输入名称"}]},B=[{label:"书号",prop:"isbn"},{label:"书名",prop:"name"},{label:"作者",prop:"author"},{label:"译者",prop:"translator"},{label:"出版单位",prop:"publisher"},{label:"出版版次",prop:"edition"},{label:"书名检索词",prop:"nameIndex"},{label:"作者检索词",prop:"authorIndex"},{label:"主题检索词",prop:"topicIndex"},{label:"分类号",prop:"classify"},{label:"CIP核字",prop:"cipNum"},{label:"数量",prop:"counts",valueType:"input-number",fieldProps:{precision:0,step:1}},{label:"书籍位置",prop:"position",valueType:"select",filterable:!0,options:b.bookPositionEnums}];return(o,a)=>{const d=_("el-button"),I=_("el-card");return N(),V(I,null,{header:r(()=>[i("div",z,[i("h4",null,w(s.pageType==="add"?"新增":"编辑")+"书籍",1),H])]),default:r(()=>[i("div",null,[f(k(M),{modelValue:k(e),"onUpdate:modelValue":a[0]||(a[0]=c=>A(e)?e.value=c:e=c),columns:B,rules:v,"row-props":{gutter:24},"col-props":{span:8},"label-position":"top",onSubmit:l},{footer:r(({handleSubmit:c})=>[i("div",O,[f(d,{type:"primary",loading:k(p),onClick:c},{default:r(()=>[h("提交")]),_:2},1032,["loading","onClick"]),f(d,{onClick:u},{default:r(()=>[h("取消")]),_:1})])]),_:1},8,["modelValue"])])]),_:1})}}});export{X as _,W as u};
