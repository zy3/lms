var A=Object.defineProperty;var T=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var _=(n,e,a)=>e in n?A(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,k=(n,e)=>{for(var a in e||(e={}))B.call(e,a)&&_(n,a,e[a]);if(T)for(var a of T(e))D.call(e,a)&&_(n,a,e[a]);return n};import"./index-BnRV7d3v.js";import{P as M}from"./index-c2-hsIFG.js";import{r as C,f as y,v as R,o as U,q as j,H as g,R as u,az as x,D as z,p as F,j as t,S as h,P as b,G as N}from"./index-B4LUeTLg.js";import{t as f,a as v}from"./common-CBPeEccM.js";import{q as G,i as H}from"./book-D9SslOf9.js";function W(){const n=C([]),e=C(!0),a=[{label:"书号",prop:"isbn",width:160},{label:"书名",prop:"bookName",width:200},{label:"读者姓名",prop:"readerName",width:100},{label:"读者类型",prop:"readerType",slot:"readerTypeSlot",width:100},{label:"年级班级",prop:"gradeClass",slot:"gradeClassSlot",width:120},{label:"学（工）号",prop:"studentNum",width:100},{label:"书籍状态",prop:"status",width:100,slot:"statusSlot"},{label:"借出时间",prop:"borrowTime",width:160},{label:"归还时间",prop:"backTime",width:160},{label:"截止时间",prop:"endTime",width:160},{label:"是否逾期",prop:"overdueInd",slot:"overdueIndSlot",width:100}],i=y({pageSize:10,currentPage:1,pageSizes:[10,20,50],total:0,align:"right",background:!0,size:"default"}),S=y({text:"正在加载第一页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `});return{loading:e,columns:a,dataList:n,pagination:i,loadingConfig:S}}const $=N("h5",null,"数据筛选",-1),J=N("h5",null,"数据列表",-1),ae=R({name:"RecordManagement",__name:"index",setup(n){let e=y({gradeClassEnums:[],readerTypeEnums:[],actionStatusEnums:[],bookOverdueEnums:[]});function a(){G().then(o=>{if(o.code===200){let l=o.data,r=f(l.gradeClassEnums);e.gradeClassEnums.push(...r);let d=f(l.readerTypeEnums);e.readerTypeEnums.push(...d);let s=f(l.actionStatusEnums);e.actionStatusEnums.push(...s);let q=f(l.bookOverdueEnums);e.bookOverdueEnums.push(...q)}else x(o.message,{type:"error"})}).catch(()=>{})}const i=C({}),S=[{label:"学（工）号",prop:"studentNum"},{label:"年级班级",prop:"gradeClass",valueType:"select",options:e.gradeClassEnums},{label:"读者姓名",prop:"readerName"},{label:"读者类型",prop:"readerType",valueType:"select",options:e.readerTypeEnums},{label:"书籍状态",prop:"status",valueType:"select",options:e.actionStatusEnums},{label:"书号",prop:"isbn"},{label:"书名",prop:"name"},{label:"是否逾期",prop:"overdueInd",valueType:"select",options:e.bookOverdueEnums}],P=o=>{m()},L=()=>{m()},{loading:c,columns:I,dataList:E,pagination:p,loadingConfig:w}=W();function O(o){p.pageSize=o,m()}function V(o){p.currentPage=o,m(),w.text=`正在加载第${o}页...`}function m(){let o=i.value,l=k({pageNo:p.currentPage,pageSize:p.pageSize},o);H(l).then(r=>{var d;r.code===200?(E.value=((d=r.data)==null?void 0:d.rows)||[],p.total=r.data.total,c.value=!1):(c.value=!1,x(r.message,{type:"error"}))}).catch(()=>{c.value=!1})}return U(()=>{a(),m()}),(o,l)=>{const r=z("el-card"),d=z("pure-table");return F(),j("div",null,[g(r,null,{header:u(()=>[$]),default:u(()=>[g(t(M),{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=s=>i.value=s),columns:S,"label-width":"90","label-position":"right",hasUnfold:!0,onSearch:P,onReset:L},null,8,["modelValue"])]),_:1}),g(r,{style:{"margin-top":"16px"}},{default:u(()=>[J,g(d,{style:{"margin-top":"16px"},border:"",stripe:"","row-key":"readerUniqueId",alignWhole:"left",showOverflowTooltip:"",loading:t(c),"loading-config":t(w),data:t(E),columns:t(I),pagination:t(p),onPageSizeChange:O,onPageCurrentChange:V},{gradeClassSlot:u(({row:s})=>[h(b(t(v)(s.gradeClass,t(e).gradeClassEnums)),1)]),readerTypeSlot:u(({row:s})=>[h(b(t(v)(s.readerType,t(e).readerTypeEnums)),1)]),statusSlot:u(({row:s})=>[h(b(t(v)(s.status,t(e).actionStatusEnums)),1)]),overdueIndSlot:u(({row:s})=>[h(b(t(v)(s.overdueInd,t(e).bookOverdueEnums)),1)]),_:1},8,["loading","loading-config","data","columns","pagination"])]),_:1})])}}});export{ae as default};
